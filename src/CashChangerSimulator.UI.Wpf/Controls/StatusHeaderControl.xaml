<UserControl x:Class="CashChangerSimulator.UI.Wpf.Controls.StatusHeaderControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:vm="clr-namespace:CashChangerSimulator.UI.Wpf.ViewModels"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             mc:Ignorable="d" 
             d:DataContext="{d:DesignInstance Type=vm:InventoryViewModel}">
    <StackPanel VerticalAlignment="Center">
        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,0,0,12">
            <Border Background="OrangeRed" 
                    CornerRadius="12" Padding="12,4" Margin="0,0,8,0"
                    Visibility="{Binding IsOverlapped.Value, Converter={StaticResource VisibilityConv}}">
                <TextBlock Text="VAL ERROR" Foreground="White" FontWeight="Bold" FontSize="11"/>
            </Border>
            <Border Background="{Binding OverallStatus.Value, Converter={StaticResource StatusBrushConv}}" 
                    CornerRadius="12" Padding="12,4" Margin="0,0,8,0">
                <TextBlock Text="{Binding OverallStatus.Value}" Foreground="White" FontWeight="Bold" FontSize="11"/>
            </Border>
            <Border Background="{Binding FullStatus.Value, Converter={StaticResource StatusBrushConv}}" 
                    CornerRadius="12" Padding="12,4">
                <TextBlock Text="{Binding FullStatus.Value}" Foreground="White" FontWeight="Bold" FontSize="11"/>
            </Border>
            <!-- Mode Indicator will be handled separately if it depends on DepositViewModel -->
        </StackPanel>
        
        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
            <ToggleButton Style="{StaticResource ModernToggleButtonStyle}"
                          IsChecked="{Binding IsJammed.Value}"
                          ToolTip="Simulate Mechanical Jam"
                          Margin="0,0,8,0">
                <ToggleButton.Content>
                    <materialDesign:PackIcon Kind="CarBrakeAlert" />
                </ToggleButton.Content>
                <materialDesign:ToggleButtonAssist.OnContent>
                    <materialDesign:PackIcon Kind="CarBrakeAlert" />
                </materialDesign:ToggleButtonAssist.OnContent>
            </ToggleButton>

            <Button Style="{StaticResource ModernActionButtonStyle}"
                    Command="{Binding OpenSettingsCommand}"
                    ToolTip="System Settings"
                    Background="{StaticResource SurfaceBrush}"
                    BorderBrush="{StaticResource PrimaryBrush}">
                <materialDesign:PackIcon Kind="Settings" Foreground="{StaticResource PrimaryBrush}"/>
            </Button>
        </StackPanel>
    </StackPanel>
</UserControl>
